(function(){$.widget("valeria.albumsTracks",{_create:function(){return this._initialize(),this._makeOperable()},_initialize:function(){return this.ui={audio:this.element.find(".track .title-cell"),lyrics:this.element.find(".track .lyrics-cell"),credits:this.element.find(".track .credits-cell"),video:this.element.find(".track .video-cell"),player:$('<div id="audio-player" />')},this.element.parent().prepend(this.ui.player)},_makeAudioOperable:function(){var e,t;return this.ui.player.jPlayer({swfPath:"/assets/javascripts/vendor",supplied:"m4a, oga, mp3, wav, webma, fla",wmode:"window",solution:"html,flash"}),t=this.ui.player,e=this.ui.audio,this.ui.audio.find(".play-button").click(function(){var i;return $(this).hasClass("_playing")?($(this).removeClass("_playing"),$(this).addClass("_paused"),t.jPlayer("pause")):$(this).hasClass("_paused")?($(this).addClass("_playing"),$(this).removeClass("_paused"),t.jPlayer("play")):(e.find(".play-button").removeClass("_playing _paused"),i=JSON.parse($(this).parent().find("#"+$(this).data("id")).text()),t.jPlayer("setMedia",i),$(this).addClass("_playing"),t.jPlayer("play"))})},_makeOperable:function(){var e;return this._makeAudioOperable(),this.ui.lyrics.find(".tip-button").click(this._openInformation),this.ui.credits.find(".tip-button").click(this._openInformation),this.ui.video.find(".play-button").click(this._openInformation),e=function(e){var t;return t=$('<iframe width="100%" height="400" frameborder="0" allowfullscreen></iframe>'),t.attr("src",e.text.data("video-url")+"&autoplay=1"),e.text.addClass("_video").append(t)},this.element.on("switched",function(){return function(t,i){return i.prev.hasClass("play-button")&&i.text.parent().find(".text[data-video-url]").removeClass("_video").empty(),i.cur.hasClass("play-button")?e(i):void 0}}(this)),this.element.on("opened",function(){return function(t,i){return i.cur.hasClass("play-button")?e(i):void 0}}(this)).on("closed",function(){return function(e,t){return t.cur.hasClass("play-button")?t.text.removeClass("_video").empty():void 0}}(this))},_openInformation:function(){var e,t,i;return t=$(this).parents("tr"),i=t.next(".track-information"),e=i.find(".text[data-id="+$(this).data("id")+"]"),t.hasClass("_opened")&&$(this).hasClass("_opened")?(i.trigger("closed",{cur:$(this),text:e}),$(this).removeClass("_opened"),e.slideUp("fast",function(){return function(){return t.removeClass("_opened"),i.removeClass("_opened"),i.find(".text").hide()}}(this))):t.hasClass("_opened")?(i.trigger("switched",{prev:t.find("._opened"),cur:$(this),text:e,text:e}),i.find(".text").hide(),e.show(),t.find(".tip-button, .play-button").removeClass("_opened"),$(this).addClass("_opened")):(i.trigger("opened",{cur:$(this),text:e}),t.addClass("_opened"),i.addClass("_opened"),i.find(".text").hide(),e.slideDown("fast"),$(this).addClass("_opened"))}})}).call(this);